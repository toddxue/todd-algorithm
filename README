Some algorithm codes from Todd Xue